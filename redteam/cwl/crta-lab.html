<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CRTA-Lab</title>

  <!-- â”€â”€â”€â”€â”€ portfolio metadata â”€â”€â”€â”€â”€ -->
  <meta name="portfolio-title"
        content="CRTA-Lab">
  <meta name="portfolio-description"
        content="End-to-end compromise of the CyberWarFare CRTA lab: external foothold, internal pivot, AD takeover and NTDS extraction.">
  <meta name="portfolio-tags"
        content="active-directory,
               kerberos, proxychains, ligolo-ng, secretsdump,
               ticketer, golden-ticket, privilege-escalation">
  <meta name="portfolio-thumb"
        content="/img/redteam/cwl/CRTA-01.png">
  <meta name="portfolio-source"
        content="CyberWarFare">
  <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->

  <link rel="stylesheet" href="/css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet" />

  <script src="/js/script.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js" defer></script>

  <!--
    Substitui o antigo crta-content.js.
    1) Injeta descriÃ§Ã£o + tags em #redteam-summary
    2) Faz fetch de crta-lab.md, converte em HTML e injeta em #markdown-content
    3) Destaca em amarelo linhas comeÃ§ando com "~$"
  -->
  <script defer>
    document.addEventListener('DOMContentLoaded', async () => {
      const getMeta = name => {
        const el = document.querySelector(`meta[name="${name}"]`);
        return el ? el.content.trim() : '';
      };

      // 1) Injeta resumo (descriÃ§Ã£o + tags)
      const description = getMeta('portfolio-description');
      const tags        = getMeta('portfolio-tags')
                           .split(',')
                           .map(t => t.trim())
                           .filter(Boolean);

      const summaryContainer = document.getElementById('redteam-summary');
      summaryContainer.innerHTML = `
        <p style="font-size:1rem;color:#bbb;margin-bottom:18px">
          ${description}
        </p>
        <div class="tag-list" style="justify-content:center">
          ${tags.map(t => `<span class="tag">${t}</span>`).join('')}
        </div>
      `;

      // 2) Faz fetch do crta-lab.md (mesma pasta que crta-lab.html)
      try {
        const resp = await fetch('crta-lab.md', { cache: 'no-cache' });
        if (!resp.ok) throw new Error('HTTP ' + resp.status);
        const mdText = await resp.text();

        const md = window.markdownit({
          html: true,
          linkify: true,
          typographer: true
        });
        const renderedHTML = md.render(mdText);

        document.getElementById('markdown-content').innerHTML = renderedHTML;

        // 3) Destaca em amarelo linhas que comeÃ§am com "~$"
        document.querySelectorAll('.markdown-body pre code').forEach(block => {
          block.innerHTML = block.innerHTML
            .split('\n')
            .map(line =>
              line.trimStart().startsWith('~$')
                ? `<span style="color:#FFD700;font-weight:bold;">${line}</span>`
                : line
            )
            .join('\n');
        });
      }
      catch (err) {
        console.error('Erro ao carregar Markdown:', err);
        document.getElementById('markdown-content').innerHTML = `
          <p style="color:red; text-align:center">
            Falha ao carregar conteÃºdo Markdown.<br>
            (${err.message})
          </p>
        `;
      }
    });
  </script>
</head>

<body class="home">
  <div id="tsparticles"></div>
  <header id="header-container"></header>

  <!-- banner da mÃ¡quina -->
  <div class="machine-banner">
    <img
      src="/img/redteam/cwl/CRTA-01.png"
      alt="CRTA-Lab Logo"
    >
  </div>

  <!-- dificuldade e plataforma -->
  <section style="text-align:center;margin-top:20px">
    <p><strong>Difficulty:</strong> Advanced</p>
    <p><strong>OS:</strong> Windows</p>
    <p>
      <a href="https://cyberwarfare.live/product/red-team-analyst-crta/"
         target="_blank"
         class="htb-link">ðŸ”— Lab Portal</a>
    </p>
  </section>

  <!-- resumo + tags (injetado por script) -->
  <section id="redteam-summary"
           style="max-width:1300px;margin:25px auto 10px;padding:0 20px;text-align:center">
  </section>

  <!-- conteÃºdo em Markdown -->
  <main class="markdown-container">
    <article id="markdown-content" class="markdown-body"></article>
  </main>
</body>
</html>